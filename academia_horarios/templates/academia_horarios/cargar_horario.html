{% extends "ui/base.html" %}
{% load static %}

{% block title %}Armar Horarios de Cátedra{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'academia_horarios/horarios.css' %}">
{% endblock %}

{% block content %}
<div class="card">
  <h2>Armar Horarios de Cátedra</h2>
  <p class="muted">Seleccioná una materia y un turno para definir los bloques horarios que ocupará la cátedra.</p>

  <div class="grid grid-cols-3 gap-3">
    <div>
      <label>Profesorado / Carrera</label>
      <select id="sel-carrera" class="input">
        <option value="">---------</option>
        {% for c in carreras %}
          <option value="{{ c.id }}">{{ c.nombre }}</option>
        {% endfor %}
      </select>
    </div>

    <div>
      <label>Plan</label>
      <select id="sel-plan" class="input" disabled>
        <option value="">---------</option>
      </select>
    </div>

    <div>
      <label>Materia</label>
      <select id="sel-materia" class="input" disabled>
        <option value="">---------</option>
      </select>
    </div>

    <div>
      <label>Período Lectivo</label>
      <select id="sel-periodo" class="input">
        <option value="">---------</option>
        {% for p in periodos %}
          <option value="{{ p.id }}">{{ p }}</option>
        {% endfor %}
      </select>
    </div>

    <div>
        <label>Turno</label>
        <select id="sel-turno" class="input">
          {% for t in turnos %}
            <option value="{{ t.id }}">{{ t.label }}</option>
          {% endfor %}
        </select>
      </div>

    <div>
      <label>Comisión</label>
      <select id="sel-comision" class="input" disabled>
        <option value="">---------</option>
      </select>
    </div>
  </div>

  <h3 class="mt-4">Grilla de Horarios</h3>
  <p class="muted">Seleccioná Plan, Materia y Turno para ver/armar la grilla.</p>

  <div id="grilla-wrapper" class="overflow-x">
    <table id="grilla" class="tabla-horaria">
      <!-- Se genera por JS -->
    </table>
  </div>

  <div class="mt-3">
    <button id="btn-guardar" class="btn btn-primary">Guardar Malla Horaria</button>
  </div>
</div>

<script>
  // Obtiene /panel o /panel/horarios a partir de la URL de api/planes
  window.HOR_BASE = "{% url 'academia_horarios:api_planes' %}".replace(/\/api\/planes\/?$/, "");
</script>
<script src="{% static 'ui/js/utils/getCookie.js' %}"></script>
<script src="{% static 'ui/js/utils/fetchJSON.js' %}"></script>
<script src="{% static 'ui/js/armar_horarios.js' %}?v=15"></script>
{% endblock %}