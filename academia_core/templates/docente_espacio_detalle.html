<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>{{ profesorado.nombre }} – {{ espacio.nombre }}</title>
  <style>
    body{font-family:Arial, sans-serif;margin:20px}
    h1{margin:0 0 10px 0}
    .muted{color:#666;font-size:13px}
    .row{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
    form input{padding:6px 8px;border:1px solid #ccc;border-radius:6px;font-size:14px}
    table{width:100%;border-collapse:collapse;font-size:14px}
    th,td{border:1px solid #ddd;padding:6px 8px}
    th{background:#f5f5f5;text-align:left}
    .center{text-align:center}
    .pill{display:inline-block;padding:2px 10px;border-radius:999px;font-size:12px;border:1px solid #ddd}
    .ok{background:#dcfce7;border-color:#86efac;color:#065f46}
    .bad{background:#fee2e2;border-color:#fecaca;color:#991b1b}
    .neutral{background:#e5e7eb;border-color:#d1d5db;color:#111827}
  </style>
</head>
<body>

  <h1>{{ espacio.nombre }}</h1>
  <div class="muted">{{ profesorado.nombre }} — Año {{ espacio.anio }} — Cuatr. {{ espacio.cuatrimestre }}</div>

  <div class="row">
    <div class="muted">
      Total: {{ resumen.total }} &nbsp;|&nbsp;
      Aprobadas: {{ resumen.aprobadas }} &nbsp;|&nbsp;
      Desaprobadas: {{ resumen.desaprobadas }} &nbsp;|&nbsp;
      Pendientes: {{ resumen.pendientes }}
    </div>
    <form method="get">
      <input type="text" name="q" value="{{ q }}" placeholder="Buscar apellido / DNI">
    </form>
  </div>

  {% if filas %}
    <table>
      <thead>
        <tr>
          <th style="width:220px;">Estudiante</th>
          <th style="width:110px;">DNI</th>
          <th style="width:90px;">Cohorte</th>
          <th style="width:140px;">Estado</th>
          <th>Último movimiento</th>
        </tr>
      </thead>
      <tbody>
        {% for r in filas %}
          <tr>
            <td>{{ r.apellido }}, {{ r.nombre }}</td>
            <td class="center">{{ r.dni }}</td>
            <td class="center">{{ r.cohorte }}</td>
            <td>
              {% if r.estado == "Aprobada" %}
                <span class="pill ok">Aprobada</span>
              {% elif r.estado == "Desaprobada" %}
                <span class="pill bad">Desaprobada</span>
              {% else %}
                <span class="pill neutral">Pendiente</span>
              {% endif %}
            </td>
            <td>{{ r.ultimo }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>No hay alumnos con movimientos en este espacio.</p>
  {% endif %}

</body>
</html>
